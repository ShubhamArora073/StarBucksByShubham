################################################################################
# Trivy Operator Helm Chart Values
# Kubernetes-native security scanning
################################################################################

# Operator configuration
operator:
  # Number of replicas
  replicas: 1
  
  # Log level
  logDevMode: false
  
  # Scan jobs configuration
  scanJobTimeout: 5m
  scanJobsConcurrentLimit: 10
  
  # Node selector
  nodeSelector:
    workload: devops
  
  # Resources
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi

# Trivy configuration
trivy:
  # Trivy image
  repository: ghcr.io/aquasecurity/trivy
  tag: "0.50.0"
  
  # Severity levels to report
  severity: UNKNOWN,LOW,MEDIUM,HIGH,CRITICAL
  
  # Ignore unfixed vulnerabilities
  ignoreUnfixed: false
  
  # Timeout for trivy scans
  timeout: 5m0s
  
  # Database repository
  dbRepository: ghcr.io/aquasecurity/trivy-db
  
  # Resources for scan jobs
  resources:
    requests:
      cpu: 100m
      memory: 100Mi
    limits:
      cpu: 500m
      memory: 500Mi

# Vulnerability reports
vulnerabilityReportsPlugin: Trivy

# Config audit reports
configAuditReportsPlugin: Trivy

# Cluster compliance
clusterComplianceEnabled: true

# RBAC Scanner
rbacAssessmentScanner: true

# Infra assessment
infraAssessmentScannerEnabled: true

# Expose metrics (disabled until monitoring stack is deployed)
serviceMonitor:
  enabled: false
  interval: 60s

# Node collector
nodeCollector:
  # Volumes to scan
  volumes:
    - name: var-lib-etcd
      hostPath:
        path: /var/lib/etcd
    - name: var-lib-kubelet
      hostPath:
        path: /var/lib/kubelet
    - name: var-lib-kube-scheduler
      hostPath:
        path: /var/lib/kube-scheduler
    - name: var-lib-kube-controller-manager
      hostPath:
        path: /var/lib/kube-controller-manager
    - name: etc-systemd
      hostPath:
        path: /etc/systemd
    - name: lib-systemd
      hostPath:
        path: /lib/systemd
    - name: etc-kubernetes
      hostPath:
        path: /etc/kubernetes
    - name: etc-cni-netd
      hostPath:
        path: /etc/cni/net.d/

# Compliance reports
compliance:
  # CIS Kubernetes Benchmark
  cron: "0 */6 * * *"
  reportType: summary

